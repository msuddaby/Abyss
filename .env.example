# ===========================================
# Abyss - Production Configuration
# ===========================================
# Copy this file to .env and fill in your values:
#   cp .env.example .env
#
# For development, see .env.dev.example instead.
# ===========================================

# ---- Database ----
# In production (docker compose), the API connects to the 'db' service internally.
# No host port is exposed — only containers can reach Postgres.
POSTGRES_USER=abyss
POSTGRES_PASSWORD=CHANGE_ME_TO_A_STRONG_RANDOM_PASSWORD
POSTGRES_DB=abyss
POSTGRES_HOST=db
POSTGRES_PORT=5432

# ---- JWT ----
# Generate a strong key: openssl rand -base64 48
JWT_KEY=CHANGE_ME_TO_A_RANDOM_64_CHAR_STRING
JWT_ISSUER=Abyss
JWT_AUDIENCE=Abyss
SYSADMIN_USERNAME=CHANGE_ME_TO_SYSADMIN_USERNAME

# ---- CORS (comma-separated) ----
# Include app://abyss for desktop app, capacitor://localhost for iOS, https://localhost for Android
CORS_ORIGINS=https://your.domain.com,app://abyss,capacitor://localhost,https://localhost

# ---- TURN / STUN ----
# TURN server public IP (used by coturn config)
TURN_EXTERNAL_IP=YOUR_PUBLIC_IP
# TURN port (coturn listening port)
TURN_PORT=3478
# TURN realm (must match coturn `realm`)
TURN_REALM=abyss
# TURN REST auth secret (must match coturn `static-auth-secret`)
TURN_AUTH_SECRET=CHANGE_ME_TO_A_STRONG_SECRET
# TURN URLs shared with clients (comma-separated)
TURN_URLS=turn:YOUR_PUBLIC_IP:3478,turn:YOUR_PUBLIC_IP:3478?transport=tcp
# TURN credential TTL in seconds (short-lived HMAC creds)
TURN_TTL_SECONDS=3600

# ---- LiveKit SFU (voice relay for restrictive networks) ----
# Generate credentials:
#   openssl rand -hex 16       → LIVEKIT_API_KEY
#   openssl rand -base64 32    → LIVEKIT_API_SECRET
# Backend uses LIVEKIT_URL to connect internally (Docker service name).
# Clients use VITE_LIVEKIT_URL via Caddy reverse proxy (/lk path, see Caddyfile.example).
LIVEKIT_API_KEY=CHANGE_ME
LIVEKIT_API_SECRET=CHANGE_ME
LIVEKIT_URL=ws://livekit:7880
VITE_LIVEKIT_URL=wss://your.domain.com/lk

# ---- Firebase ----
# Path to Firebase service account JSON key file (for push notifications)
# In Docker: the file should be placed in project root as firebase-service-account.json
# The docker-compose.yml mounts it to /app/firebase-service-account.json
# For local dev: use absolute path to your service account file
FIREBASE_SERVICE_ACCOUNT_PATH=/app/firebase-service-account.json

# ---- Frontend (VITE_ prefix required by Vite) ----
VITE_API_URL=https://your.domain.com
VITE_STUN_URL=stun:stun.l.google.com:19302
# Giphy API key (get one at https://developers.giphy.com/)
VITE_GIPHY_API_KEY=your_giphy_api_key_here
